<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" name="viewport" content="text/html, charset=utf-8, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=3.0">
<title>CG homework -- 410406116</title>
<style>
#info {
  position: absolute;
  top: 2%;
  width: 100%;
  padding: 10px;
  text-align: center;
  color: #ffff00
}

body {
  overflow: hidden;
}
</style>
</head>

<body> 
<div id="info">HW1
  <br/>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/84/three.min.js">
</script>
<script src="https://threejs.org/examples/js/controls/OrbitControls.js">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r16/Stats.min.js"></script>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="https://jyunming-chen.github.io/tutsplus/js/KeyboardState.js"></script>
<script>
var keyboard = new KeyboardState();
var renderer, camera, controls, scene, axes;
var stats;
var theta1 = 0;
var theta2 = 0;
var theta3 = 0;
var move = 0;
var fbase,fturret,fcannon,fturn,ftank;
init();
animate();
function buildParts() {
    var parts = [];
    
	var mat = new THREE.MeshNormalMaterial()
	var base = new THREE.Object3D();
	var baseMesh = new THREE.Mesh (new THREE.BoxGeometry (40,10,20), mat);
	base.add (baseMesh);
	baseMesh.position.set (-10,5,0);
	parts.push (base);

    var turret = new THREE.Mesh (new THREE.CylinderGeometry (10,10,10, 30),mat);
    parts.push (turret);
    
    var turn = new THREE.Object3D();
    var turnMesh = new THREE.Mesh (new THREE.CylinderGeometry (1.5, 1.5, 10, 30), mat);
    turn.add (turnMesh);
    turnMesh.rotation.x = Math.PI/2;
    parts.push (turn);
    
    var cannon = new THREE.Object3D()
    var cannon0 = new THREE.Object3D()
    var cannonMesh = new THREE.Mesh (new THREE.CylinderGeometry (1.5, 1.5, 10, 30), mat);
    cannon0.add (cannonMesh);
    cannonMesh.position.y = 5;
    cannon.add (cannon0);
    cannon0.rotation.z = -Math.PI/2;
    parts.push (cannon);
    
    return parts;
}

function buildTank(){

  let parts = buildParts();
  
  let tank = new THREE.Object3D();

  fbase = parts[0]
  tank.add (fbase);
  
  fturret = parts[1]
  tank.add (fturret)
  fturret.position.set (0, 15, 0);
  console.log (theta1);
  fturret.rotation.y = theta1;
  
  fturn = parts[2]
  fturn.position.x = 10
  fturn.rotation.z = theta2;
  fturret.add (fturn);
  
  fcannon = parts[3]
  fturn.add (fcannon);
  
  return tank;
}


function init() {
	renderer = new THREE.WebGLRenderer({
	  antialias: true
	});
	renderer.setSize(window.innerWidth, window.innerHeight);
	renderer.setClearColor(0x888888);
	document.body.appendChild(renderer.domElement);
	camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 1000);
	camera.position.z = 50;  // important

	controls = new THREE.OrbitControls(camera, renderer.domElement);
	scene = new THREE.Scene();
	  
	let gridXZ = new THREE.GridHelper(100, 10, 'red', 'white');
	scene.add(gridXZ);

	let axes = new THREE.AxisHelper (10);
	scene.add (axes);
  
	 ftank = buildTank();
  scene.add (ftank);
  
	angle = 0;
}

function animate() {
  controls.update();
  renderer.render (scene, camera);

	angle = angle + 0.01;  // radian
	ftank.rotation.y = angle + Math.PI/2;
  //console.log (angle)
  
  ftank.position.set (30*Math.cos(angle), 0, -30*Math.sin(angle));
  
  requestAnimationFrame (animate);
}
</script>
</body>

</html>